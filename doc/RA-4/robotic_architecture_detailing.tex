\section{Step RA-4: Robotic Architecture Detailing}
\subsection{Implementation Strategies}
This section shows the implementation strategies for the services modeled in the previous section. Some services might be totally or partially acquired from open online repositories. The implementation strategy might change according to a necessity or limitation occurring later during project implementation.

\subsubsection*{Camera Sensor Service}
The camera sensor model is yet to be decided. It is positioned in front of the robot at an angle and height yet to be decided. The camera sensor, it's angle, and it's height will be determined during implementation because it requires tests to function effectively. 
%Determine camera - options: Actual Pioneer camera or Jackal's Camera
\subsubsection*{Sonar Sensor Service}
The sonar sensor service is an abstraction of the sixteen sonars. The sonars are positioned on the front and the rear of the robot, eight on the front and eight on the rear, each with a different angle. The service communicates directly with the sensors, gathers them, and organizes in structured data providing the distance registered by each sonar.
%Already implemented in the pioneer?
\subsubsection*{Fork Lift Actuator Service}
The fork lift actuator service controls the fork lift directly. The fork lift only moves in one axis, up and down.
%ros control prismatic joint - already implemented
\subsubsection*{Drive Actuator Service}
The drive actuator service controls the motors of the two wheels responsible for moving the robot. The service will implement differential drive and provide an abstraction for easily moving the robot, through only linear and angular movement.

\subsubsection*{Image Processing Service}
The image processing service processes the images provided by the camera service providing the identification of the guide lines. The service takes in raw images and provides structured data identifying the guide lines and line crossings. The processed data identifies the relational position of the lines according to the robot, both linearly and angularly.

\subsubsection*{Map Information Service}
The map information service stores the map shared between all the robots. The map stores the guide lines grid in a graph representation. The map contains the position of each robot and product area in the graph.

\subsubsection*{Localization Service}
The localization service looks into the camera images to provide the position of the robot in the map. The localization service takes in the processed images identifying the guide lines and crossings to determine, once it sees a crossing, what path it took to update it's actual position.

\subsubsection*{Navigation Service}
The navigation service is responsible for keeping the robot following the line and take the correct turns once it reaches a crossing. The service takes in the processed camera images identifying the relational position of the robot according to the guide lines and turns the robot right, left of keeps going straight to successfully follow the guide line. The service also executes paths generated by the path planning service. It takes the path and checks the actual localization and the next step necessary to keep following the path, go straight, turn right, go straight, or occasionally reverse direction.

\subsubsection*{Path Planning Service}
The path planning service calculates the Manhattan distance between the map positions and determines the shortest path between two map positions. To determine the best path between two map positions the service uses the graph representation of the map to apply the dijkstra algorithm.

\subsubsection*{Object Manipulation Service}
The object manipulation abstracts the manipulation of the object, picking up and releasing. The object manipulation service makes uses the sonar sensor service data to localize the position of the product in relationship to the robot, then it moves the fork lift to pick the product up, navigates to it and positions the fork in the correct position for lifting it up. The last step is to lift the product to carrying to position. 
% \subsubsection*{Communication Service}

\subsubsection*{Operation Service}
The operation service provides an interface for an operator to manually drive the robot. The service sends messages to the robot as the operator presses the arrows or awsd keys of the keyboard in the computer that has access to the terminal that where the service is active.

\subsubsection*{Control Service}
The control service coordinates the services navigation service and object manipulation service. The service communicates the product area where the product must be transported from to the navigation service, once the robot is done navigating to the product area the control uses the object manipulation service to pick the object up. Then it communicates the product area where the product must be delivered to the navigation service, again, once it is done, uses the object manipulation service to release the object.

\subsubsection*{Robotic Agent Service}
The robotic agent service is the abstraction of the robot itself. The service communicates with other robots to determine the closest one to the product and internalizing the transport in the robot.

\subsubsection*{Application Service}
The application service is the interface with the operator to request a new transport. The service communicate to all robots to decide which robot will do the transport and the product areas where the must be transported from and delivered. 

\subsection{Deployment}
The Deployment subsection describes where where the services will be physically running, either in the robots or in the back-end server. 

\subsubsection{Back-End Server}
The operation service provides an interface for an operator to control the robot remotely. 
The application service provides an interface for adding new product transport requests.
The map information service will use the back-end server to keep map redundancy and coherent.

\subsubsection{Robots}
Every device driver and actuator must control devices as quickly as possible, therefore stay operate in the robot.
The path planning and image processing services run often and perform core operations for the robots' navigation, therefor also require to be implemented in the robot.
